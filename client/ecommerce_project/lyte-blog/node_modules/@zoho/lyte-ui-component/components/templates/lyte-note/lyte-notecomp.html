<template tag-name = "lyte-notecomp">
	
	<div class="lyteNoteMainComment">
		<%if(ltPropAvatar){%>
			<img src={{ltPropAvatar}} class="lyteNoteMainCommentAvatar">
		<%}%>
		<lyte-note-editor from-main = true lt-prop-text-editor = {{ltPropTextEditor}} lt-prop-edit-mode = {{lbind(ltPropEditMode)}} lt-prop-buttons = {{ltPropButtons}} on-trigger = "{{method('onTrigger')}}" lt-prop-editor-panel = {{ltPropEditorPanel}} lt-prop-file-upload = {{ltPropFileUpload}} lt-prop-editor-animation = {{ltPropEditorAnimation}} lt-prop-tooltip-config = {{ltPropTooltipConfig}} lt-prop-text = {{ltPropText}} close-comment = "{{method('close_comment')}}" sanitizer = {{sanitizer}}></lyte-note-editor>
	</div>

	<div class="lyteNoteCommentWrapper">
		<%ltPropPinnedComments.forEach( function( item, index ){%>
			<lyte-comment lt-prop-pinned-comment = true id = "pinned_{{item.id}}" data-index = pin_{{index}} class = "lyteNotePinnedComment" onclick="{{action('pinned',event,this,item)}}" onmouseenter="{{action('pinEnter',this,event)}}" lt-prop-value = {{lbind(item.value)}} sanitizer = {{sanitizer}}>
				<template is = "registerYield" yield-name = "lyte-pinned-note" from-parent item = {{item}}></template>
			</lyte-comment>
		<%})
		ltPropComments.forEach( function( item, index ){%>
			<lyte-comment id = {{item.id}} class = "lyteNoteComment {{item.class}}" lt-prop = "{{stringify(item)}}" lt-prop-edit = {{item.edit}} lt-prop-delete = {{item.delete}} lt-prop-value = {{lbind(item.value)}} on-time-conversion = "{{method('timeConversion')}}" data-index = {{concat(index)}} lt-prop-reply = {{item.reply}} lt-prop-header = {{item.header}} lt-prop-footer = {{item.footer}} lt-prop-emoji = {{item.emoji}} lt-prop-edit-mode = {{lbind(item.editmode)}} lt-prop-buttons = {{ltPropButtons}} on-trigger = "{{method('onTrigger')}}" lt-prop-text-editor = {{ltPropTextEditor}} lt-prop-editor-panel = {{ltPropEditorPanel}} lt-prop-file-upload = {{ltPropFileUpload}} lt-prop-attachments = {{item.attachments}} lt-prop-style = {{item.style}} lt-prop-editor-animation = {{ltPropEditorAnimation}} lt-prop-tooltip-config = {{ltPropTooltipConfig}} lt-prop-text = {{ltPropText}} lt-prop-voice-note = {{item.voiceNote}} lt-prop-pin = {{item.pin}} sanitizer = {{sanitizer}}>
				<template is = "registerYield" yield-name = "lyte-note-checkin" from-parent></template>
			</lyte-comment>
		<%})
		if(ltPropPinnedComments.length){%>
			<lyte-menu lt-prop-yield = true lt-prop-query = ".lyteNoteUnpinIcon" on-menu-click = "{{method('unpinSelect')}}" lt-prop-wrapper-class = "lyteNoteUnpinMenu">
				<template is = "registerYield" yield-name = "yield">
					<lyte-menu-body>
						<lyte-menu-item data-value = "unpin" class = "lyteNoteUnpinOption">{{ltPropText.unpin}}</lyte-menu-item>
					</lyte-menu-body>
				</template>
			</lyte-menu>
			<lyte-hovercard lt-prop-class = "lyteNotePinTooltipWrapper" lt-prop-show = "{{lbind(pinShow)}}" lt-prop-origin-elem = ".lyteNotePinOrigin" on-hovercard-hide = "{{method('pinHide')}}" lt-prop-hide-on-click = true lt-prop-keep-alive = true>
				<template is = "registerYield" yield-name = "hoverCardYield">
					<lyte-hovercard-content>
						<span class="lyteNotePinMessage">{{unescape(pin.message)}}</span>
						<span class="lyteNotePinnedTime">{{pin.time}}</span>
					</lyte-hovercard-content>
				</template>
			</lyte-hovercard>
		<%}%>
	</div>

	<lyte-popover class = "lyteNoteEmojiPopover" lt-prop = "{{stringify(ltPropPopover)}}" lt-prop-origin-elem = ".lyte_note_origin_elem" lt-prop-show = {{lbind(popoverShow)}}>
		<template is = "registerYield" yield-name = "popover">
			<lyte-emoji lt-prop = "{{stringify(ltPropEmojiProps)}}" on-emoji-select = "{{method('emojiselect')}}" lt-prop-tooltip-config = {{ltPropTooltipConfig}}></lyte-emoji>
		</template>
	</lyte-popover>

	<%if(!ltPropColors){%>
		<lyte-colorpicker lt-prop = "{{stringify(ltPropColorPicker)}}" lt-prop-origin-element = ".lyte_note_bgswitch_elem" lt-prop-show = {{lbind(bgSwitch)}} on-select = "{{method('colorPickerSelect')}}" lt-prop-wrapper-class = 'lyteNoteBgSwitcherPopover'></lyte-colorpicker>
	<%}%>

	<lyte-messagebox lt-prop-type = "info" lt-prop-show = {{lbind(messageShow)}} lt-prop-message = {{message}}></lyte-messagebox>

	<lyte-menu lt-prop-wrapper-class = "lyteNoteOptionsMenu" lt-prop-yield = true lt-prop-query = ".lyteNoteCommentMoreOptions" on-menu-click = "{{method('optionsMenuSelect')}}" on-before-open = "{{method('beforeOpenOptionsMenu')}}" on-before-close = "{{method('beforeCloseOptionsMenu')}}">
		<template is = "registerYield" yield-name = "yield">
			<lyte-menu-body>
				<lyte-menu-item data-value = "delete" class = "lyteNoteDeleteOption {{if(isDelete,'','lyteEditorHide')}}">{{ltPropText.delete}}</lyte-menu-item>
				<lyte-menu-item data-value = "pin" class = "lyteNotePinOption {{if(isPin,'','lyteEditorHide')}}">{{if(isPinned, ltPropText.unpin, ltPropText.pin)}}</lyte-menu-item>
				<lyte-menu-item data-value = "view" class = "lyteNoteViewReactionsOption {{if(isReact,'','lyteEditorHide')}}">{{ltPropText.viewReactions}}</lyte-menu-item>
			</lyte-menu-body>
		</template>
	</lyte-menu>

	<%if(renderView){%>
		<lyte-reaction-view lt-prop-show = {{lbind(showViewArray)}} lt-prop-comment = {{lbind(currentComment)}} lt-prop-tooltip-config = {{ltPropTooltipConfig}} lt-prop-text = {{ltPropText}} on-time-conversion = "{{method('timeConversion')}}" lt-prop = {{ltPropReaction}}></lyte-reaction-view>
	<%}
	if(editAlertRender){%>
		<lyte-alert lt-prop-top = 0 lt-prop-yield = true lt-prop-wrapper-class = "lyteNoteAlert" lt-prop-show = {{lbind(alertShow)}}>
			<template is = "registerYield" yield-name = "alert">
				<lyte-alert-header>{{ltPropText.editAlertHeader}}</lyte-alert-header>
				<lyte-alert-content>{{ltPropText.editAlertMessage}}</lyte-alert-content>
				<lyte-alert-footer>
					<lyte-button class = "lyteNoteKeepEditingButton" onclick = "{{action('keepedit')}}">
						<template is = "registerYield" yield-name = "text">
							{{ltPropText.keepEditing}}
						</template>
					</lyte-button>
					<lyte-button class = "lyteNoteContinueButton" lt-prop-appearance="failure" onclick = "{{action('continue')}}">
						<template is = "registerYield" yield-name = "text">
							{{ltPropText.continue}}
						</template>
					</lyte-button>
				</lyte-alert-footer>
			</template>
		</lyte-alert>
	<%}%>

	<lyte-hovercard lt-prop-class = "lyteNoteEmojiTooltipWrapper" lt-prop-show = "{{lbind(hovercardShow)}}" lt-prop-origin-elem = ".lyteNoteHoverOrigin" on-hovercard-hide = "{{method('hoverHide')}}" lt-prop-hide-on-click = true lt-prop-keep-alive = true>
		<template is = "registerYield" yield-name = "hoverCardYield">
			<lyte-hovercard-content>
				<div class="lyteNoteEmojiTooltipTitle">{{hoverEmoji.name}}</div>
				<ul class="lyteNoteEmojiTooltipNames">
					<%hoverEmoji.reacted.forEach(function(item){%>
						<li class="lyteNoteEmojiIndividualName">{{item}}</li>
					<%})%>
				</ul>
			</lyte-hovercard-content>
		</template>
	</lyte-hovercard>

	<lyte-colorbox lt-prop-yield = 'true' on-before-open = "{{method('cboxBeforeOpen')}}" on-navigate = "{{method('cboxNavigate')}}" on-close = '{{method("cboxClose")}}'>
		<template is = "registerYield" yield-name = "colorBoxYield">
			<div id="lyteColorbox" class="lyteColorbox lyteCBox lyteNoteComponentColorbox">
				<div class="lyteColorboxFreezeLayer lyteCBoxOverlay"></div>
				<div class="lyteColorboxWrapper">
					<div class="lyteColorboxUtilDiv {{if(isImage, '', 'lyteCBoxDNImp')}}">
						<span class="lyteCBoxZoomOut lyteColorboxZoomOut lyteColorboxDisabled"></span>
						<span class="lyteCBoxReset lyteColorboxReset lyteColorboxDisabled"></span>
						<span class="lyteCBoxZoomIn lyteColorboxZoomIn"></span>
					</div>
					<div class="lyteColorboxContent lyteCBoxContent" style="position: unset;">
						<span class="lyteColorboxLoadingImg"></span>
						<%if(isNoPreview){%>
							<div class="lyteNoteComponentNoPreviewWrap">
								<span class="lyteNoteComponentNoPreviewIcon {{previewType}}"></span>
								<span class="lyteNoteComponentNoPreviewMessage">{{ltPropText.noPreviewMessage}}</span>
							</div>
						<%}%>
					</div>
					<div class="lyteColorboxHeader">
						<div class="lyteNoteComponentFileDetailWrapper">
							<div class="lyteColorboxTitle lyteCBoxTitle" onmouseenter="{{action('enter',this)}}" lt-prop-tooltip-title = "lyteNoteColorBoxTooltip" lt-prop-tooltip-config = {{ltPropTooltipConfig}}></div>
							<div class="lyteNoteComponentFileDetail">
								<span class="lyteNoteComponentFileDate" lt-prop-title = {{previewDate.tooltip}} lt-prop-tooltip-config = {{ltPropTooltipConfig}} lt-prop-tooltip-class = "lyteNoteColorboxTooltip">{{previewDate.display}}</span>
								<span class="lyteNoteComponentFileSize">{{fileSize}}</span>
							</div>
						</div>
						<div class="lyteColorboxDownloadDiv lyteCBoxDownload">
							<span class="lyteColorboxDownloadImg"></span>
						</div>
					</div>
				</div>
				<div class="lyteColorboxCloseIcon lyteCBoxClose"></div>
				<div class="lyteColorboxIconDiv lyteCBoxPrevious {{prevIconClass}}">
					<div class="lyteColorboxPreviousIcon"></div>
				</div>
				<div class="lyteColorboxIconDiv lyteCBoxNext {{nextIconClass}}">
					<div class="lyteColorboxNextIcon"></div>
				</div>
				<div class="lyteColorboxThumbInnerWrapper">
					<%thumbnails.forEach(function(item, index){%>
						<div class="lyteColorboxThumb {{if(ifEquals(index,thumbIndex),'thumb-on','')}}" data-thumb-val = {{thumbnailValue}} onclick="{{action('thumbClick',index)}}">
							<%if( item.ctype == "photo" ){%>
								<img class="lyteNoteColorboxImg" src="{{item.src}}">
							<%}else{%>
								<div class="lyteCBoxIframeWrap">
									<div class="lyteCBoxIframeIcon"></div>
									<div class="lyteCBoxIframeLabel">{{item.fileType}}</div>
								</div>
							<%}%>
						</div>
					<%})%>
				</div>
			</div>
		</template>
	</lyte-colorbox>

</template>